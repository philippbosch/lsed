(function(a){a.jQTouch=function(e){a.support.WebKitCSSMatrix=(typeof WebKitCSSMatrix=="object");a.support.touch=(typeof Touch=="object");a.support.WebKitAnimationEvent=(typeof WebKitTransitionEvent=="object");var u,q=a("head"),k=[],i=0,m={},j,w,d,b=RegExp(" Mobile/").test(navigator.userAgent),f=true,v=0,E=[],s={},D=a.jQTouch.prototype.extensions,F=["slide","flip","slideup","swap","cube","pop","dissolve","fade","back"],o=[],h="";x(e);function x(J){var M={addGlossToIcon:true,backSelector:".back, .cancel, .goback",cacheGetRequests:true,cubeSelector:".cube",dissolveSelector:".dissolve",fadeSelector:".fade",fixedViewport:true,flipSelector:".flip",formSelector:"form",fullScreen:true,fullScreenClass:"fullscreen",icon:null,touchSelector:"a, .touch",popSelector:".pop",preloadImages:false,slideSelector:"#jqt > * > ul li a, .slide",slideupSelector:".slideup",startupScreen:null,statusBar:"default",submitSelector:".submit",swapSelector:".swap",useAnimations:true,useFastTouch:true};m=a.extend({},M,J);if(m.preloadImages){for(var K=m.preloadImages.length-1;K>=0;K--){(new Image()).src=m.preloadImages[K]}}if(m.icon){var L=(m.addGlossToIcon)?"":"-precomposed";h+='<link rel="apple-touch-icon'+L+'" href="'+m.icon+'" />'}if(m.startupScreen){h+='<link rel="apple-touch-startup-image" href="'+m.startupScreen+'" />'}if(m.fixedViewport){h+='<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0;"/>'}if(m.fullScreen){h+='<meta name="apple-mobile-web-app-capable" content="yes" />';if(m.statusBar){h+='<meta name="apple-mobile-web-app-status-bar-style" content="'+m.statusBar+'" />'}}if(h){q.prepend(h)}a(document).ready(function(){for(var P in D){var Q=D[P];if(a.isFunction(Q)){a.extend(s,Q(s))}}for(var P in F){var O=F[P];var N=m[O+"Selector"];if(typeof(N)=="string"){z({name:O,selector:N})}}E.push("input");E.push(m.touchSelector);E.push(m.backSelector);E.push(m.submitSelector);a(E.join(", ")).css("-webkit-touch-callout","none");a(m.backSelector).tap(n);a(m.submitSelector).tap(r);u=a("#jqt");if(m.fullScreenClass&&window.navigator.standalone==true){u.addClass(m.fullScreenClass+" "+m.statusBar)}u.bind("touchstart",H).bind("orientationchange",B).trigger("orientationchange").submit(p);if(m.useFastTouch&&a.support.touch){u.click(function(S){var R=a(S.target);if(R.attr("nodeName")!=="A"&&R.attr("nodeName")!=="AREA"&&R.attr("nodeName")!=="INPUT"){R=R.closest("a, area")}if(R.isExternalLink()){return true}else{return false}});u.mousedown(function(R){var S=(new Date()).getTime()-v;if(S<200){return false}})}if(a("#jqt > .current").length==0){w=a("#jqt > *:first")}else{w=a("#jqt > .current:first");a("#jqt > .current").removeClass("current")}a(w).addClass("current");location.hash="#"+a(w).attr("id");t(w);scrollTo(0,0);A()})}function I(N){if(k.length<=1){window.history.go(-2)}var M=Math.min(parseInt(N||1,10),k.length-1),L=k[0];if(isNaN(M)&&typeof(N)==="string"&&N!="#"){for(var J=1,K=k.length;J<K;J++){if("#"+k[J].id===N){M=J;break}}}if(isNaN(M)||M<1){M=1}if(k.length>1){k.splice(0,M);g(L.page,k[0].page,L.animation,L.reverse===false)}else{location.hash="#"+L.id}return s}function G(L,M,J){var N=k[0].page;if(typeof(M)==="string"){for(var K=o.length-1;K>=0;K--){if(o[K].name===M){M=o[K];break}}}if(typeof(L)==="string"){nextPage=a(L);if(nextPage.length<1){y(L,{animation:M});return}else{L=nextPage}}if(g(N,L,M,J)){t(L,M,J);return s}else{console.error("Could not animate pages.");return false}}function l(){return d}function n(O){var K=a(O.target);if(K.attr("nodeName")!=="A"&&K.attr("nodeName")!=="AREA"){K=K.closest("a, area")}var N=K.attr("target"),M=K.attr("hash"),L=null;if(f==false||!K.length){console.warn("Not able to tap element.");return false}if(K.isExternalLink()){K.removeClass("active");return true}for(var J=o.length-1;J>=0;J--){if(K.is(o[J].selector)){L=o[J];break}}if(N=="_webapp"){window.location=K.attr("href")}else{if(K.is(m.backSelector)){I(M)}else{if(K.attr("href")=="#"){K.unselect();return true}else{if(M&&M!="#"){K.addClass("active");G(a(M).data("referrer",K),L,a(this).hasClass("reverse"))}else{K.addClass("loading active");y(K.attr("href"),{animation:L,callback:function(){K.removeClass("loading");setTimeout(a.fn.unselect,250,K)},$referrer:K})}}}}return false}function t(M,L,K){var J=M.attr("id");k.unshift({page:M,animation:L,reverse:K||false,id:J})}function g(N,L,M,K){if(L.length===0){a.fn.unselect();console.error("Target element is missing.");return false}if(L.hasClass("current")){a.fn.unselect();console.error("Target element is the current page.");return false}a(":focus").blur();N.css("top",-window.pageYOffset);L.css("top",0);scrollTo(0,0);var O=function J(Q){if(M){L.removeClass("in "+M.name);N.removeClass("current out "+M.name);if(K){L.toggleClass("reverse");N.toggleClass("reverse")}}else{N.removeClass("current")}L.trigger("pageAnimationEnd",{direction:"in"});N.trigger("pageAnimationEnd",{direction:"out"});clearInterval(j);w=L;location.hash="#"+w.attr("id");A();var P=L.data("referrer");if(P){P.unselect()}v=(new Date()).getTime();f=true};N.trigger("pageAnimationStart",{direction:"out"});L.trigger("pageAnimationStart",{direction:"in"});if(a.support.WebKitAnimationEvent&&M&&m.useAnimations){L.one("webkitAnimationEnd",O);f=false;if(K){L.toggleClass("reverse");N.toggleClass("reverse")}L.addClass(M.name+" in current");N.addClass(M.name+" out")}else{L.addClass("current");O()}return true}function C(){var J=w.attr("id");if(location.hash!="#"+J){clearInterval(j);I(location.hash)}else{if(location.hash==""){location.hash="#"+J}}}function A(){j=setInterval(C,100)}function c(J,K){var L=null;a(J).each(function(N,O){var M=a(this);if(!M.attr("id")){M.attr("id","page-"+(++i))}u.trigger("pageInserted",{page:M.appendTo(u)});if(M.hasClass("current")||!L){L=M}});if(L!==null){G(L,K);return L}else{return false}}function y(J,K){var M={data:null,method:"GET",animation:null,callback:null,$referrer:null};var L=a.extend({},M,K);if(J!="#"){a.ajax({url:J,data:L.data,type:L.method,success:function(N,P){var O=c(N,L.animation);if(O){if(L.method=="GET"&&m.cacheGetRequests===true&&L.$referrer){L.$referrer.attr("href","#"+O.attr("id"))}if(L.callback){L.callback(true)}}},error:function(N){if(L.$referrer){L.$referrer.unselect()}if(L.callback){L.callback(false)}}})}else{if(L.$referrer){L.$referrer.unselect()}}}function p(K,L){var J=(typeof(K)==="string")?a(K).eq(0):(K.target?a(K.target):a(K));if(J.length&&J.is(m.formSelector)){y(J.attr("action"),{data:J.serialize(),method:J.attr("method")||"POST",animation:o[0]||null,callback:L});return false}return true}function r(L){var K=a(this).closest("form");if(K.length){var J=a.Event("submit");J.preventDefault();K.trigger(J);return false}return true}function z(J){if(typeof(J.selector)=="string"&&typeof(J.name)=="string"){o.push(J);a(J.selector).tap(n);E.push(J.selector)}}function B(){d=Math.abs(window.orientation)==90?"landscape":"profile";u.removeClass("profile landscape").addClass(d).trigger("turn",{orientation:d})}function H(R){var V=a(R.target);if(!a(R.target).is(E.join(", "))){var S=a(R.target).closest("a, area");if(S.length&&S.is(E.join(", "))){V=S}else{return}}if(R){var J=null,P=event.changedTouches[0].clientX,O=event.changedTouches[0].clientY,K=(new Date).getTime(),N=0,L=0,Q=0;V.bind("touchmove",M).bind("touchend",T);J=setTimeout(function(){V.makeActive()},100)}function M(Y){U();var X=Math.abs(N);var W=Math.abs(L);if(X>W&&(X>35)&&Q<1000){V.trigger("swipe",{direction:(N<0)?"left":"right",deltaX:N,deltaY:L}).unbind("touchmove",M).unbind("touchend",T)}else{if(W>1){V.removeClass("active")}}clearTimeout(J)}function T(){U();if(L===0&&N===0){V.makeActive();V.trigger("tap")}else{V.removeClass("active")}V.unbind("touchmove",M).unbind("touchend",T);clearTimeout(J)}function U(){var W=event.changedTouches[0]||null;N=W.pageX-P;L=W.pageY-O;Q=(new Date).getTime()-K}}a.fn.unselect=function(J){if(J){J.removeClass("active")}else{a(".active").removeClass("active")}};a.fn.makeActive=function(){return a(this).addClass("active")};a.fn.swipe=function(J){if(a.isFunction(J)){return a(this).bind("swipe",J)}else{return a(this).trigger("swipe")}};a.fn.tap=function(K){if(a.isFunction(K)){var J=(m.useFastTouch&&a.support.touch)?"tap":"click";return a(this).live(J,K)}else{return a(this).trigger("tap")}};a.fn.isExternalLink=function(){var J=a(this);return(J.attr("target")=="_blank"||J.attr("rel")=="external"||J.is('input[type="checkbox"], input[type="radio"], a[href^="http://maps.google.com:"], a[href^="mailto:"], a[href^="tel:"], a[href^="javascript:"], a[href*="youtube.com/v"], a[href*="youtube.com/watch"]'))};s={getOrientation:l,goBack:I,goTo:G,addAnimation:z,submitForm:p};return s};a.jQTouch.prototype.extensions=[];a.jQTouch.addExtension=function(b){a.jQTouch.prototype.extensions.push(b)}})(jQuery);